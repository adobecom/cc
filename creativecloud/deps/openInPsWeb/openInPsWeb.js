const openInPsWeb = (function(e,n,t,o){return new Promise(((a,r)=>{import("./e2bb343a.js").then((i=>{const s=new URL(e);s.pathname="embed-content-proxy.html";const c=s.searchParams;c.append("origin",document.location.origin),s.search=c.toString();const d=document.createElement("iframe");d?(d.style.display="none",window.addEventListener("message",(async e=>{if(e.source!==d.contentWindow)return;if("psweb-embed-content-proxy-denied"===e.data)r(new Error("proxy denied"));else if("psweb-embed-content-proxy-ready"!==e.data)return;if(!d.contentWindow)return void r(new Error("proxyFrame.contentWindow null"));const c=i.getProxy(d.contentWindow,window,s.origin),m=`manifest_${(Math.random()+1).toString(36).substring(7)}`,p=[],w=t.map(((e,n)=>{const t=`${m}_imageData${n}/${e.filename}`;try{p.push(c.set(t,e.imageData))}catch(e){r(new Error(`proxy.set failed when writing ${t}, ${e}`))}return{filename:e.filename,imagePath:t}}));await Promise.all(p);const l={inputs:[{href:w[0].imagePath,storage:"idb"}],options:{actionJSON:o}};w.slice(1).length>0&&(l.options.additionalImages=w.slice(1).map((e=>({href:e.imagePath,storage:"idb"}))));const g={version:2,filename:n,data:l};await c.set(m,JSON.stringify(g));const h={proxyid:m,proxytype:"manifest"};s.searchParams.has("PR")&&(h.PR=s.searchParams.get("PR"));const f=new URLSearchParams(h),y=new URL(`${s.origin}/id?${f}`);(window.top??window).location.assign(y),d.remove(),a()})),d.src=s.href,document.body.appendChild(d)):r(new Error("could not create proxy iframe"))}))}))});
export { openInPsWeb }