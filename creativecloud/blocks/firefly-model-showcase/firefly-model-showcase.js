import { createTag, getLibs } from '../../scripts/utils.js';
import addParallaxProgress from '../../features/parallax.js';

// Constants
const GALLERY_SRC_URL = 'https://main--cc--adobecom.aem.live/drafts/jingle/ff-gallery-assets.json';
const CHICKET_ICONS = [
  {
    name: 'adobe',
    background: '#EB1000',
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 30" fill="none">
  <path d="M0 4.67188H16.3318V9.9804H6.21133V13.8173H15.1672V19.1259H6.21133V27.0435H0V4.67188Z" fill="white"/>
  <path d="M18.9414 9.61035H24.7916V27.0526H18.9414V9.61035Z" fill="white"/>
  <path d="M22.8671 6.387L24.9525 6.85646C25.7741 7.03703 26.3429 6.06199 25.7651 5.44808L24.3206 3.88622C24.131 3.67857 24.0497 3.3987 24.1129 3.11883L24.5824 1.04237C24.763 0.22984 23.7879 -0.33893 23.165 0.229841L21.5941 1.67434C21.3864 1.86393 21.0975 1.93615 20.8267 1.88198L18.7412 1.41252C17.9197 1.23196 17.3509 2.20699 17.9287 2.8209L19.3732 4.38277C19.5628 4.59041 19.644 4.87028 19.5808 5.15015L19.1114 7.22662C18.9308 8.03915 19.9058 8.60792 20.5288 8.03915L22.0997 6.59465C22.3073 6.40506 22.5962 6.33284 22.8671 6.387Z" fill="white"/>
</svg>
`,
  },
  {
    name: 'openai',
    background: '#FFF',
    svg: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 27 28" fill="none">
  <path d="M24.9988 11.2965C25.6142 9.4171 25.4023 7.35827 24.4182 5.64876C22.9382 3.02671 19.9631 1.67773 17.0575 2.31254C15.7649 0.830733 13.9077 -0.0119472 11.9607 0.000128018C8.9907 -0.00677213 6.35545 1.93907 5.44172 4.81471C3.53373 5.21233 1.88681 6.42762 0.923073 8.15007C-0.567886 10.7652 -0.227992 14.0618 1.76391 16.3043C1.14854 18.1837 1.36044 20.2426 2.34453 21.9521C3.82447 24.5741 6.7996 25.9231 9.70524 25.2883C10.997 26.7701 12.855 27.6128 14.802 27.5999C17.7737 27.6076 20.4098 25.6601 21.3235 22.7818C23.2315 22.3842 24.8784 21.1689 25.8422 19.4465C27.3314 16.8313 26.9907 13.5374 24.9996 11.2948L24.9988 11.2965ZM14.8037 25.7963C13.6144 25.7981 12.4625 25.3746 11.5497 24.5992C11.5912 24.5767 11.6632 24.5362 11.7099 24.5069L17.1109 21.3328C17.3872 21.1732 17.5567 20.8739 17.555 20.5505V12.8025L19.8377 14.1437C19.8622 14.1558 19.8783 14.1799 19.8817 14.2075V20.6238C19.8783 23.477 17.6076 25.7903 14.8037 25.7963ZM3.88295 21.0499C3.28708 20.0028 3.07263 18.7754 3.27691 17.5843C3.31674 17.6084 3.3871 17.6524 3.43711 17.6818L8.83812 20.8558C9.1119 21.0188 9.45095 21.0188 9.72558 20.8558L16.3192 16.9814V19.6638C16.3209 19.6914 16.3082 19.7182 16.287 19.7354L10.8275 22.9431C8.39567 24.368 5.29 23.521 3.8838 21.0499H3.88295ZM2.4615 9.05312C3.05483 8.0043 3.99145 7.20216 5.10691 6.78556C5.10691 6.833 5.10437 6.91666 5.10437 6.97532V13.3243C5.10267 13.6469 5.2722 13.9462 5.54767 14.1058L12.1413 17.9793L9.85865 19.3205C9.83577 19.3361 9.80695 19.3387 9.78152 19.3274L4.32117 16.1171C1.89444 14.6871 1.06208 11.5277 2.46065 9.05398L2.4615 9.05312ZM21.2159 13.4942L14.6223 9.6198L16.9049 8.27944C16.9278 8.26392 16.9566 8.26133 16.982 8.27254L22.4424 11.4802C24.8734 12.9094 25.7066 16.074 24.3021 18.5477C23.7079 19.5948 22.7721 20.397 21.6575 20.8144V14.2757C21.66 13.9531 21.4914 13.6547 21.2167 13.4942H21.2159ZM23.4875 10.0148C23.4477 9.98982 23.3773 9.94669 23.3273 9.91737L17.9263 6.7433C17.6525 6.58028 17.3134 6.58028 17.0388 6.7433L10.4452 10.6177V7.9353C10.4435 7.9077 10.4562 7.88096 10.4774 7.86371L15.9369 4.65859C18.3687 3.23112 21.4778 4.0807 22.8798 6.55613C23.4722 7.6015 23.6867 8.82542 23.4858 10.0148H23.4875ZM9.20429 14.7958L6.92081 13.4546C6.89623 13.4425 6.88013 13.4183 6.87674 13.3907V6.97445C6.87843 4.11779 9.15598 1.80279 11.9633 1.80452C13.1508 1.80452 14.3002 2.22888 15.2131 3.00169C15.1715 3.02412 15.1003 3.06466 15.0529 3.09398L9.65184 6.26805C9.37551 6.42762 9.20599 6.72605 9.20768 7.04949L9.20429 14.794V14.7958ZM10.4444 12.0754L13.3814 10.3495L16.3183 12.0745V15.5255L13.3814 17.2505L10.4444 15.5255V12.0754Z" fill="black"/>
</svg>
`,
  },
];

// Services
async function fetchGalleryAssets() {
  const res = await fetch(GALLERY_SRC_URL);
  const response = await res.json();
  return response.data;
}

function buildGalleryOutline(parentElem) {
  // Gallery will be a masonry grid with 4 columns
  const galleryOutline = createTag('div', {
    class: 'firefly-model-showcase-gallery',
  });

  // Create 4 columns
  for (let i = 0; i < 4; i += 1) {
    const column = createTag('div', { class: 'gallery-column' });

    const cellCount = i < 2 ? 2 : 3;
    for (let j = 0; j < cellCount; j += 1) {
      const cell = createTag('div', { class: 'gallery-cell' });
      column.appendChild(cell);
    }

    galleryOutline.appendChild(column);
  }

  parentElem.appendChild(galleryOutline);
}

export default async function init(el) {
  const miloLibs = getLibs('/libs');
  const { decorateButtons } = await import(`${miloLibs}/utils/decorate.js`);
  const showcaseContentElem = el.querySelector(':scope > div');
  // Add class to container for styling
  showcaseContentElem.classList.add('firefly-model-showcase-content');
  // Decorate buttons
  el.classList.add('l-button');
  await decorateButtons(el);

  buildGalleryOutline(el);

  addParallaxProgress(el);
}
